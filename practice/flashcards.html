<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Flashcards ‚Äî Yespa√±ol</title>
    <link rel="stylesheet" href="../css/design-system.css">
    <style>
        :root {
            --bg-primary: #000000;
            --bg-glass: rgba(28, 28, 30, 0.72);
            --bg-glass-hover: rgba(255, 255, 255, 0.1);
            --border-glass: rgba(255, 255, 255, 0.08);
            --text-primary: #ffffff;
            --text-secondary: rgba(235, 235, 245, 0.6);
            --text-tertiary: rgba(235, 235, 245, 0.3);
            /* Practice - Emerald theme (growth, progress) */
            --accent: #10b981;
            --accent-light: #34d399;
            --accent-dark: #059669;
            --success: #30d158;
            --danger: #ff453a;
            --card-radius: 24px;
            --nav-height: 72px;
            --safe-bottom: env(safe-area-inset-bottom, 0px);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
            touch-action: pan-y;
        }

        html, body {
            height: 100%;
            overflow: hidden;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            -webkit-font-smoothing: antialiased;
        }

        .ambient-bg {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            pointer-events: none;
            z-index: 0;
            background: radial-gradient(circle at 30% 30%, rgba(255, 107, 74, 0.06) 0%, transparent 50%),
                        radial-gradient(circle at 70% 70%, rgba(100, 100, 255, 0.04) 0%, transparent 50%);
        }

        .app-container {
            position: relative;
            z-index: 1;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 48px 20px 12px;
            flex-shrink: 0;
        }

        .back-btn {
            width: 40px;
            height: 40px;
            background: var(--bg-glass);
            border: 1px solid var(--border-glass);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-primary);
            text-decoration: none;
            font-size: 1.2rem;
        }

        .header-title {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .card-count {
            font-size: 0.9rem;
            color: var(--text-secondary);
            min-width: 40px;
            text-align: right;
        }

        /* Progress bar */
        .progress-container {
            padding: 0 20px;
            margin-bottom: 12px;
            flex-shrink: 0;
        }

        .progress-bar {
            height: 4px;
            background: rgba(255,255,255,0.1);
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), #ff8a6a);
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        /* Card stack area */
        .card-stack {
            flex: 1;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px 20px;
            overflow: visible;
            min-height: 0;
        }

        /* Flashcard */
        .flashcard {
            position: absolute;
            width: calc(100% - 48px);
            max-width: 340px;
            height: auto;
            min-height: 280px;
            max-height: calc(100% - 40px);
            background: linear-gradient(145deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.03) 100%);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--border-glass);
            border-radius: var(--card-radius);
            cursor: grab;
            user-select: none;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 28px 24px;
            text-align: center;
            transition: transform 0.1s ease, box-shadow 0.3s ease;
            will-change: transform;
        }

        .flashcard::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.15), transparent);
        }

        .flashcard.grabbing {
            cursor: grabbing;
        }

        .flashcard.swiping-right {
            box-shadow: 0 0 40px rgba(50, 215, 75, 0.3);
        }

        .flashcard.swiping-left {
            box-shadow: 0 0 40px rgba(255, 69, 58, 0.3);
        }

        .flashcard.behind {
            transform: scale(0.95) translateY(10px);
            opacity: 0.6;
            pointer-events: none;
        }

        .flashcard.far-behind {
            transform: scale(0.9) translateY(20px);
            opacity: 0.3;
            pointer-events: none;
        }

        .flashcard.exiting {
            transition: transform 0.4s ease, opacity 0.4s ease;
            pointer-events: none;
        }

        /* Card content */
        .card-category {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 24px;
        }

        .card-word {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 8px;
            line-height: 1.2;
        }

        .card-pronunciation {
            font-size: 1rem;
            color: var(--text-tertiary);
            font-style: italic;
            margin-bottom: 24px;
        }

        .card-divider {
            width: 40px;
            height: 2px;
            background: var(--accent);
            opacity: 0.5;
            margin: 16px 0;
        }

        .card-answer {
            font-size: 1.5rem;
            font-weight: 500;
            color: var(--text-secondary);
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
        }

        .flashcard.revealed .card-answer {
            opacity: 1;
            transform: translateY(0);
        }

        .card-example {
            font-size: 0.95rem;
            color: var(--text-tertiary);
            margin-top: 20px;
            line-height: 1.5;
            opacity: 0;
            transition: opacity 0.3s ease 0.1s;
        }

        .flashcard.revealed .card-example {
            opacity: 1;
        }

        .tap-hint {
            position: absolute;
            bottom: 24px;
            font-size: 0.75rem;
            color: var(--text-tertiary);
            transition: opacity 0.3s ease;
        }

        .flashcard.revealed .tap-hint {
            opacity: 0;
        }

        /* Swipe indicators */
        .swipe-indicator {
            position: absolute;
            top: 24px;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .swipe-indicator.left {
            left: 24px;
            background: rgba(255, 69, 58, 0.2);
            color: var(--danger);
            border: 2px solid var(--danger);
        }

        .swipe-indicator.right {
            right: 24px;
            background: rgba(50, 215, 75, 0.2);
            color: var(--success);
            border: 2px solid var(--success);
        }

        .flashcard.swiping-left .swipe-indicator.left,
        .flashcard.swiping-right .swipe-indicator.right {
            opacity: 1;
        }

        /* Action buttons */
        .actions {
            display: flex;
            justify-content: center;
            gap: 24px;
            padding: 16px 20px calc(24px + var(--safe-bottom));
            flex-shrink: 0;
        }

        .action-btn {
            width: 64px;
            height: 64px;
            border-radius: 50%;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .action-btn:active {
            transform: scale(0.9);
        }

        .action-btn.skip {
            background: rgba(255, 69, 58, 0.15);
            border: 2px solid var(--danger);
            color: var(--danger);
        }

        .action-btn.reveal {
            background: var(--bg-glass);
            border: 2px solid var(--border-glass);
            color: var(--text-primary);
            width: 56px;
            height: 56px;
            font-size: 1.2rem;
        }

        .action-btn.got-it {
            background: rgba(50, 215, 75, 0.15);
            border: 2px solid var(--success);
            color: var(--success);
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 40px;
        }

        .empty-icon {
            font-size: 4rem;
            margin-bottom: 16px;
        }

        .empty-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .empty-desc {
            color: var(--text-secondary);
            margin-bottom: 24px;
        }

        .restart-btn {
            background: var(--accent);
            color: #000;
            border: none;
            padding: 14px 28px;
            border-radius: 14px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
        }

        /* Stats modal */
        .stats-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(10px);
            z-index: 200;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .stats-overlay.visible {
            display: flex;
        }

        .stats-modal {
            background: var(--bg-glass);
            border: 1px solid var(--border-glass);
            border-radius: var(--card-radius);
            padding: 32px;
            text-align: center;
            max-width: 340px;
            width: 100%;
        }

        .stats-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 24px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-box {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 16px;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
        }

        .stat-number.green { color: var(--success); }
        .stat-number.red { color: var(--danger); }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-tertiary);
            text-transform: uppercase;
            margin-top: 4px;
        }

        /* Bottom nav */
        .bottom-nav {
            position: fixed;
            bottom: 0; left: 0; right: 0;
            height: calc(var(--nav-height) + var(--safe-bottom));
            padding-bottom: var(--safe-bottom);
            background: rgba(10, 10, 15, 0.8);
            backdrop-filter: blur(30px);
            border-top: 1px solid var(--border-glass);
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 100;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px 20px;
            color: var(--text-tertiary);
            text-decoration: none;
        }

        .nav-item.active { color: var(--accent); }
        .nav-icon { font-size: 1.5rem; }
        .nav-label {
            font-size: 0.65rem;
            font-weight: 500;
            text-transform: uppercase;
        }
    </style>
</head>
<body>
    <div class="ambient-bg"></div>

    <div class="app-container">
        <header class="header">
            <a href="../index.html" class="back-btn">‚Üê</a>
            <span class="header-title">Flashcards</span>
            <span class="card-count" id="cardCount">1/20</span>
        </header>

        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 5%"></div>
            </div>
        </div>

        <div class="card-stack" id="cardStack">
            <!-- Cards injected by JS -->
        </div>

        <div class="actions">
            <button class="action-btn skip" id="btnSkip" title="Need practice">‚úï</button>
            <button class="action-btn reveal" id="btnReveal" title="Reveal answer">üëÅ</button>
            <button class="action-btn got-it" id="btnGotIt" title="Got it!">‚úì</button>
        </div>
    </div>

    <div class="stats-overlay" id="statsOverlay">
        <div class="stats-modal">
            <div class="stats-title">Session Complete!</div>
            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-number green" id="statCorrect">0</div>
                    <div class="stat-label">Got It</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number red" id="statReview">0</div>
                    <div class="stat-label">Need Review</div>
                </div>
            </div>
            <button class="restart-btn" onclick="restartSession()">Practice Again</button>
        </div>
    </div>

    <nav class="bottom-nav">
        <a href="../index.html" class="nav-item">
            <span class="nav-icon">üè†</span>
            <span class="nav-label">Home</span>
        </a>
        <a href="flashcards.html" class="nav-item active">
            <span class="nav-icon">üÉè</span>
            <span class="nav-label">Review</span>
        </a>
        <a href="../progress.html" class="nav-item">
            <span class="nav-icon">üìä</span>
            <span class="nav-label">Progress</span>
        </a>
        <a href="../settings.html" class="nav-item">
            <span class="nav-icon">‚öôÔ∏è</span>
            <span class="nav-label">Settings</span>
        </a>
    </nav>

    <script>
        // Flashcard data - mixed vocabulary and grammar
        const cardData = [
            { category: 'Vocabulary', word: 'desarrollar', pronunciation: 'deh-sah-roh-YAR', answer: 'to develop', example: '"Necesitamos desarrollar nuevas ideas."' },
            { category: 'Ser vs Estar', word: 'Ella ___ doctora.', pronunciation: 'profession', answer: 'es (ser)', example: 'Professions use SER ‚Äî it\'s who you are.' },
            { category: 'Vocabulary', word: 'sin embargo', pronunciation: 'seen em-BAR-go', answer: 'however, nevertheless', example: '"Es dif√≠cil; sin embargo, lo haremos."' },
            { category: 'Ser vs Estar', word: 'La puerta ___ abierta.', pronunciation: 'condition/state', answer: 'est√° (estar)', example: 'States & conditions use ESTAR ‚Äî it can change.' },
            { category: 'Por vs Para', word: 'Gracias ___ tu ayuda.', pronunciation: 'reason/cause', answer: 'por', example: 'POR = because of, due to (the reason)' },
            { category: 'Vocabulary', word: 'aprovechar', pronunciation: 'ah-pro-veh-CHAR', answer: 'to take advantage of', example: '"Hay que aprovechar el momento."' },
            { category: 'Por vs Para', word: 'Este regalo es ___ ti.', pronunciation: 'recipient', answer: 'para', example: 'PARA = for (recipient, destination)' },
            { category: 'Vocabulary', word: 'a pesar de', pronunciation: 'ah peh-SAR deh', answer: 'despite, in spite of', example: '"A pesar de la lluvia, salimos."' },
            { category: 'Subjunctive', word: 'Espero que t√∫ ___ (venir)', pronunciation: 'wish/hope trigger', answer: 'vengas', example: 'Esperar + que = subjunctive' },
            { category: 'Vocabulary', word: 'lograr', pronunciation: 'lo-GRAR', answer: 'to achieve, manage to', example: '"Logr√© terminar el proyecto."' },
            { category: 'Ser vs Estar', word: '¬øC√≥mo ___? (asking how someone is)', pronunciation: 'temporary state', answer: 'est√°s (estar)', example: 'How you\'re feeling = temporary = ESTAR' },
            { category: 'Vocabulary', word: 'realizar', pronunciation: 'reh-ah-lee-SAR', answer: 'to carry out (NOT "to realize")', example: '"Vamos a realizar el plan." (False friend!)' },
            { category: 'Por vs Para', word: 'Trabajo ___ una empresa grande.', pronunciation: 'employer', answer: 'para', example: 'PARA = for (who you work for)' },
            { category: 'Vocabulary', word: 'destacar', pronunciation: 'des-tah-CAR', answer: 'to stand out, highlight', example: '"Quiero destacar este punto."' },
            { category: 'Subjunctive', word: 'Dudo que √©l ___ (saber)', pronunciation: 'doubt trigger', answer: 'sepa', example: 'Dudar + que = subjunctive' },
            { category: 'Vocabulary', word: 'mediante', pronunciation: 'meh-dee-AN-teh', answer: 'through, by means of', example: '"Lo logramos mediante trabajo duro."' },
            { category: 'Ser vs Estar', word: 'La fiesta ___ en mi casa.', pronunciation: 'location of event', answer: 'es (ser)', example: 'Events use SER for location!' },
            { category: 'Vocabulary', word: 'en cuanto a', pronunciation: 'en KWAN-toh ah', answer: 'as for, regarding', example: '"En cuanto a tu pregunta..."' },
            { category: 'Por vs Para', word: 'Caminamos ___ el parque.', pronunciation: 'through/along', answer: 'por', example: 'POR = through, along, around' },
            { category: 'Vocabulary', word: 'echar de menos', pronunciation: 'eh-CHAR deh MEH-nos', answer: 'to miss (someone/thing)', example: '"Te echo de menos." = I miss you.' },
            { category: 'Past Tenses', word: 'Ayer ___ (comer) una pizza.', pronunciation: 'completed action', answer: 'com√≠ (preterite)', example: 'Completed action with clear end = PRETERITE' },
            { category: 'Past Tenses', word: 'De ni√±o, ___ (jugar) al f√∫tbol todos los d√≠as.', pronunciation: 'habitual action', answer: 'jugaba (imperfect)', example: 'Habitual/repeated past action = IMPERFECT' },
            { category: 'Past Tenses', word: 'Mientras ___ (caminar), vi a mi amigo.', pronunciation: 'background action', answer: 'caminaba (imperfect)', example: 'Background/ongoing action = IMPERFECT' },
            { category: 'Past Tenses', word: 'El a√±o pasado ___ (ir) a Espa√±a tres veces.', pronunciation: 'specific count', answer: 'fui (preterite)', example: 'Specific number of times = PRETERITE' },
            { category: 'False Friends', word: 'embarazada', pronunciation: 'ehm-bah-rah-SAH-dah', answer: 'pregnant (NOT embarrassed)', example: 'Use "avergonzado" for embarrassed!' },
            { category: 'False Friends', word: '√©xito', pronunciation: 'EHK-see-toh', answer: 'success (NOT exit)', example: '"Fue un gran √©xito" = It was a great success' },
            { category: 'False Friends', word: 'actual', pronunciation: 'ahk-too-AHL', answer: 'current (NOT actual)', example: '"El presidente actual" = The current president' },
            { category: 'False Friends', word: 'realizar', pronunciation: 'reh-ah-lee-SAHR', answer: 'to accomplish (NOT realize)', example: 'Use "darse cuenta" for "to realize"' },
            { category: 'False Friends', word: 'sensible', pronunciation: 'sehn-SEE-bleh', answer: 'sensitive (NOT sensible)', example: 'Use "sensato" for sensible/reasonable' },
            { category: 'False Friends', word: 'soportar', pronunciation: 'soh-pohr-TAHR', answer: 'to tolerate (NOT support)', example: 'Use "apoyar" for support' },
            { category: 'Idioms', word: 'estar en las nubes', pronunciation: 'ehs-TAHR ehn lahs NOO-behs', answer: 'to be daydreaming', example: '"Siempre est√° en las nubes" = He\'s always daydreaming' },
            { category: 'Idioms', word: 'meter la pata', pronunciation: 'meh-TEHR lah PAH-tah', answer: 'to put your foot in it / mess up', example: '"Met√≠ la pata en la reuni√≥n" = I messed up at the meeting' },
            { category: 'Idioms', word: 'no tener pelos en la lengua', pronunciation: 'noh teh-NEHR PEH-lohs...', answer: 'to speak one\'s mind / be blunt', example: 'She doesn\'t have hairs on her tongue = She speaks her mind' },
            { category: 'Idioms', word: 'costar un ojo de la cara', pronunciation: 'kohs-TAHR oon OH-hoh...', answer: 'to cost an arm and a leg', example: '"Este coche me cost√≥ un ojo de la cara"' },
            { category: 'Idioms', word: 'tomar el pelo', pronunciation: 'toh-MAHR ehl PEH-loh', answer: 'to pull someone\'s leg / joke', example: '"¬øMe est√°s tomando el pelo?" = Are you kidding me?' },
            // More Vocabulary - Emotions
            { category: 'Vocabulary', word: 'agotado/a', pronunciation: 'ah-goh-TAH-doh', answer: 'exhausted', example: '"Estoy agotado despu√©s del viaje."' },
            { category: 'Vocabulary', word: 'abrumado/a', pronunciation: 'ah-broo-MAH-doh', answer: 'overwhelmed', example: '"Me siento abrumado con tanto trabajo."' },
            { category: 'Vocabulary', word: 'aliviado/a', pronunciation: 'ah-lee-vee-AH-doh', answer: 'relieved', example: '"Estoy aliviado de que todo sali√≥ bien."' },
            { category: 'Vocabulary', word: 'decepcionado/a', pronunciation: 'deh-sep-see-oh-NAH-doh', answer: 'disappointed', example: '"Qued√© decepcionado con los resultados."' },
            { category: 'Vocabulary', word: 'entusiasmado/a', pronunciation: 'ehn-too-see-ahs-MAH-doh', answer: 'excited/enthusiastic', example: '"Estoy entusiasmado con el proyecto."' },
            // More Vocabulary - Connectors
            { category: 'Vocabulary', word: 'no obstante', pronunciation: 'noh ohb-STAHN-teh', answer: 'nevertheless', example: '"No obstante, seguimos adelante."' },
            { category: 'Vocabulary', word: 'por lo tanto', pronunciation: 'pohr loh TAHN-toh', answer: 'therefore', example: '"Llueve, por lo tanto no saldremos."' },
            { category: 'Vocabulary', word: 'de hecho', pronunciation: 'deh EH-choh', answer: 'in fact', example: '"De hecho, ya lo sab√≠a."' },
            { category: 'Vocabulary', word: 'puesto que', pronunciation: 'PWEHS-toh keh', answer: 'since/given that', example: '"Puesto que no viniste, empezamos sin ti."' },
            { category: 'Vocabulary', word: 'siempre y cuando', pronunciation: 'SEEEHM-preh ee KWAHN-doh', answer: 'as long as', example: '"Ir√© siempre y cuando t√∫ vengas."' },
            // More Vocabulary - Abstract/Professional
            { category: 'Vocabulary', word: 'el enfoque', pronunciation: 'ehl ehn-FOH-keh', answer: 'approach/focus', example: '"Necesitamos un nuevo enfoque."' },
            { category: 'Vocabulary', word: 'el √°mbito', pronunciation: 'ehl AHM-bee-toh', answer: 'field/scope', example: '"En el √°mbito profesional..."' },
            { category: 'Vocabulary', word: 'gestionar', pronunciation: 'hehs-tee-oh-NAHR', answer: 'to manage', example: '"Gestiona un equipo de diez personas."' },
            { category: 'Vocabulary', word: 'desempe√±ar', pronunciation: 'deh-sehm-peh-NYAHR', answer: 'to perform/carry out', example: '"Desempe√±a un papel importante."' },
            { category: 'Vocabulary', word: 'surgir', pronunciation: 'soor-HEER', answer: 'to arise/emerge', example: '"Surgi√≥ un problema inesperado."' },
            // More Vocabulary - Relationships
            { category: 'Vocabulary', word: 'llevarse bien', pronunciation: 'yeh-VAHR-seh bee-EHN', answer: 'to get along well', example: '"Me llevo muy bien con ella."' },
            { category: 'Vocabulary', word: 'caerle bien', pronunciation: 'kah-EHR-leh bee-EHN', answer: 'to like someone', example: '"Me cae muy bien tu hermano."' },
            { category: 'Vocabulary', word: 'contar con', pronunciation: 'kohn-TAHR kohn', answer: 'to count on/rely on', example: '"Puedes contar conmigo siempre."' },
            { category: 'Vocabulary', word: 'hacer falta', pronunciation: 'ah-SEHR FAHL-tah', answer: 'to be needed', example: '"Hace falta m√°s tiempo."' },
            { category: 'Vocabulary', word: 'darse cuenta', pronunciation: 'DAHR-seh KWEHN-tah', answer: 'to realize', example: '"Me di cuenta de mi error."' },
            // More Subjunctive
            { category: 'Subjunctive', word: 'Quiero que t√∫ ___ (hablar)', pronunciation: 'want/wish trigger', answer: 'hables', example: 'Querer + que = subjunctive' },
            { category: 'Subjunctive', word: 'Es importante que ___ (estudiar)', pronunciation: 'impersonal expression', answer: 'estudies', example: 'Es importante/necesario + que = subjunctive' },
            { category: 'Subjunctive', word: 'No creo que ___ (ser) verdad', pronunciation: 'negated belief', answer: 'sea', example: 'No creer + que = subjunctive' },
            { category: 'Subjunctive', word: 'Ojal√° ___ (poder) ir', pronunciation: 'oh-hah-LAH', answer: 'pueda/pudiera', example: 'Ojal√° always triggers subjunctive' },
            { category: 'Subjunctive', word: 'Cuando ___ (llegar), ll√°mame', pronunciation: 'future uncertainty', answer: 'llegues', example: 'Cuando + future action = subjunctive' },
            // More Idioms
            { category: 'Idioms', word: 'dar en el clavo', pronunciation: 'dahr ehn ehl KLAH-voh', answer: 'to hit the nail on the head', example: '"¬°Diste en el clavo!" = You got it exactly right!' },
            { category: 'Idioms', word: 'estar hasta las narices', pronunciation: 'ehs-TAHR AHS-tah lahs nah-REE-sehs', answer: 'to be fed up', example: '"Estoy hasta las narices de esperar"' },
            { category: 'Idioms', word: 'no tener ni pies ni cabeza', pronunciation: 'noh teh-NEHR nee pee-EHS...', answer: 'to make no sense', example: '"Esta historia no tiene ni pies ni cabeza"' },
            { category: 'Idioms', word: 'quedarse en blanco', pronunciation: 'keh-DAHR-seh ehn BLAHN-koh', answer: 'to go blank / forget', example: '"Me qued√© en blanco en el examen"' },
            { category: 'Idioms', word: 'ser pan comido', pronunciation: 'sehr pahn koh-MEE-doh', answer: 'to be a piece of cake', example: '"Este ejercicio es pan comido"' },
            // More False Friends
            { category: 'False Friends', word: 'largo', pronunciation: 'LAHR-goh', answer: 'long (NOT large)', example: 'Use "grande" for large. Largo = long' },
            { category: 'False Friends', word: 'carpeta', pronunciation: 'kahr-PEH-tah', answer: 'folder (NOT carpet)', example: 'Use "alfombra" for carpet' },
            { category: 'False Friends', word: 'molestar', pronunciation: 'moh-lehs-TAHR', answer: 'to bother (NOT molest)', example: '"No me molestes" = Don\'t bother me' },
            { category: 'False Friends', word: 'contestar', pronunciation: 'kohn-tehs-TAHR', answer: 'to answer (NOT contest)', example: '"Contesta el tel√©fono" = Answer the phone' },
            // More Grammar
            { category: 'Ser vs Estar', word: 'El caf√© ___ fr√≠o.', pronunciation: 'result of change', answer: 'est√° (estar)', example: 'Result of a change = ESTAR (it became cold)' },
            { category: 'Ser vs Estar', word: 'Mi hermano ___ alto.', pronunciation: 'physical trait', answer: 'es (ser)', example: 'Inherent physical traits = SER' },
            { category: 'Por vs Para', word: 'Salimos ___ la ma√±ana.', pronunciation: 'time of day', answer: 'por', example: 'POR = during (general time)' },
            { category: 'Por vs Para', word: 'Lo necesito ___ ma√±ana.', pronunciation: 'deadline', answer: 'para', example: 'PARA = by (deadline)' },
            { category: 'Past Tenses', word: '___ (hacer) mucho calor ese d√≠a.', pronunciation: 'weather/description', answer: 'hac√≠a (imperfect)', example: 'Weather descriptions = IMPERFECT' },
            { category: 'Past Tenses', word: 'De repente, ___ (empezar) a llover.', pronunciation: 'sudden action', answer: 'empez√≥ (preterite)', example: 'Sudden/interrupting action = PRETERITE' },
            // === MASSIVE EXPANSION ===
            // More Vocabulary - Advanced
            { category: 'Vocabulary', word: 'plantear', pronunciation: 'plahn-teh-AHR', answer: 'to raise/pose (a question)', example: '"Quiero plantear una duda."' },
            { category: 'Vocabulary', word: 'abordar', pronunciation: 'ah-bohr-DAHR', answer: 'to address/tackle', example: '"Debemos abordar este tema."' },
            { category: 'Vocabulary', word: 'carecer', pronunciation: 'kah-reh-SEHR', answer: 'to lack', example: '"Carece de experiencia."' },
            { category: 'Vocabulary', word: 'conllevar', pronunciation: 'kohn-yeh-VAHR', answer: 'to entail/involve', example: '"Este trabajo conlleva responsabilidad."' },
            { category: 'Vocabulary', word: 'proporcionar', pronunciation: 'proh-pohr-see-oh-NAHR', answer: 'to provide/supply', example: '"Te proporcionar√© la informaci√≥n."' },
            { category: 'Vocabulary', word: 'prescindir', pronunciation: 'prehs-seen-DEER', answer: 'to do without', example: '"No puedo prescindir del caf√©."' },
            { category: 'Vocabulary', word: 'abarcar', pronunciation: 'ah-bahr-KAHR', answer: 'to encompass/cover', example: '"El estudio abarca varios temas."' },
            { category: 'Vocabulary', word: 'el matiz', pronunciation: 'ehl mah-TEES', answer: 'nuance', example: '"Hay un matiz importante aqu√≠."' },
            { category: 'Vocabulary', word: 'el v√≠nculo', pronunciation: 'ehl VEEN-koo-loh', answer: 'bond/link', example: '"Existe un v√≠nculo entre ellos."' },
            { category: 'Vocabulary', word: 'la pauta', pronunciation: 'lah POW-tah', answer: 'guideline/pattern', example: '"Sigue esta pauta."' },
            { category: 'Vocabulary', word: 'el desenlace', pronunciation: 'ehl deh-sehn-LAH-seh', answer: 'outcome/ending', example: '"Nadie esperaba ese desenlace."' },
            { category: 'Vocabulary', word: 'tramitar', pronunciation: 'trah-mee-TAHR', answer: 'to process (paperwork)', example: '"Necesito tramitar el visado."' },
            { category: 'Vocabulary', word: 'asombrado/a', pronunciation: 'ah-sohm-BRAH-doh', answer: 'amazed', example: '"Qued√© asombrado con la noticia."' },
            { category: 'Vocabulary', word: 'desconcertado/a', pronunciation: 'dehs-kohn-sehr-TAH-doh', answer: 'puzzled/bewildered', example: '"Me dej√≥ desconcertado."' },
            { category: 'Vocabulary', word: 'arrepentido/a', pronunciation: 'ah-reh-pehn-TEE-doh', answer: 'regretful', example: '"Est√° arrepentido de sus palabras."' },
            // More Grammar - Ser vs Estar
            { category: 'Ser vs Estar', word: 'El partido ___ a las ocho.', pronunciation: 'event time', answer: 'es (ser)', example: 'Event times use SER' },
            { category: 'Ser vs Estar', word: 'La sopa ___ muy caliente.', pronunciation: 'temporary state', answer: 'est√° (estar)', example: 'Current state = ESTAR' },
            { category: 'Ser vs Estar', word: 'Mi abuela ___ de Espa√±a.', pronunciation: 'origin', answer: 'es (ser)', example: 'Origin uses SER' },
            { category: 'Ser vs Estar', word: 'Ella ___ lista para salir.', pronunciation: 'ready (state)', answer: 'est√° (estar)', example: 'Estar listo = ready (state)' },
            { category: 'Ser vs Estar', word: '√âl ___ muy listo.', pronunciation: 'clever (trait)', answer: 'es (ser)', example: 'Ser listo = clever (trait)' },
            { category: 'Ser vs Estar', word: 'La manzana ___ verde.', pronunciation: 'unripe (state)', answer: 'est√° (estar)', example: 'Estar verde = unripe/not ready' },
            { category: 'Ser vs Estar', word: 'El coche ___ de mi padre.', pronunciation: 'possession', answer: 'es (ser)', example: 'Possession uses SER' },
            { category: 'Ser vs Estar', word: '¬øD√≥nde ___ el ba√±o?', pronunciation: 'location', answer: 'est√° (estar)', example: 'Location always = ESTAR' },
            // More Grammar - Por vs Para
            { category: 'Por vs Para', word: 'Estudio espa√±ol ___ mi trabajo.', pronunciation: 'purpose', answer: 'para', example: 'PARA = in order to/purpose' },
            { category: 'Por vs Para', word: 'Te llam√© ___ tel√©fono.', pronunciation: 'means', answer: 'por', example: 'POR = by means of' },
            { category: 'Por vs Para', word: 'Lo hice ___ ti.', pronunciation: 'on behalf of', answer: 'por', example: 'POR = on behalf of/for your sake' },
            { category: 'Por vs Para', word: 'Salgo ___ Madrid ma√±ana.', pronunciation: 'destination', answer: 'para', example: 'PARA = destination/heading to' },
            { category: 'Por vs Para', word: 'Pagu√© $50 ___ el libro.', pronunciation: 'exchange', answer: 'por', example: 'POR = in exchange for' },
            { category: 'Por vs Para', word: '___ m√≠, est√° bien.', pronunciation: 'opinion', answer: 'Para', example: 'PARA = in my opinion' },
            { category: 'Por vs Para', word: 'Vamos ___ la costa.', pronunciation: 'along/through', answer: 'por', example: 'POR = along/through area' },
            { category: 'Por vs Para', word: 'Es alto ___ su edad.', pronunciation: 'comparison', answer: 'para', example: 'PARA = for/considering' },
            // More Subjunctive
            { category: 'Subjunctive', word: 'Te pido que ___ (tener) paciencia.', pronunciation: 'request', answer: 'tengas', example: 'Pedir + que = subjunctive' },
            { category: 'Subjunctive', word: 'Me alegro de que ___ (estar) aqu√≠.', pronunciation: 'emotion', answer: 'est√©s', example: 'Emotion + que = subjunctive' },
            { category: 'Subjunctive', word: 'Busco alguien que ___ (hablar) ingl√©s.', pronunciation: 'unknown antecedent', answer: 'hable', example: 'Unknown/hypothetical = subjunctive' },
            { category: 'Subjunctive', word: 'Aunque ___ (llover), ir√©.', pronunciation: 'even if', answer: 'llueva', example: 'Aunque + hypothetical = subjunctive' },
            { category: 'Subjunctive', word: 'Antes de que ___ (salir)...', pronunciation: 'before', answer: 'salgas', example: 'Antes de que always = subjunctive' },
            { category: 'Subjunctive', word: 'No hay nadie que ___ (saber) eso.', pronunciation: 'negative existence', answer: 'sepa', example: 'Negative + que = subjunctive' },
            { category: 'Subjunctive', word: 'Es posible que ___ (venir) tarde.', pronunciation: 'possibility', answer: 'venga', example: 'Es posible + que = subjunctive' },
            { category: 'Subjunctive', word: 'Tan pronto como ___ (llegar)...', pronunciation: 'as soon as (future)', answer: 'llegue', example: 'Future time clause = subjunctive' },
            // More Past Tenses
            { category: 'Past Tenses', word: '___ (ser) las dos cuando llegu√©.', pronunciation: 'time in past', answer: 'Eran (imperfect)', example: 'Time in past = IMPERFECT' },
            { category: 'Past Tenses', word: 'Ella ___ (tener) 20 a√±os entonces.', pronunciation: 'age in past', answer: 'ten√≠a (imperfect)', example: 'Age in past = IMPERFECT' },
            { category: 'Past Tenses', word: 'Ayer ___ (ver) una pel√≠cula.', pronunciation: 'completed action', answer: 'vi (preterite)', example: 'Completed yesterday = PRETERITE' },
            { category: 'Past Tenses', word: 'Cuando era ni√±o, ___ (vivir) en Madrid.', pronunciation: 'habitual past', answer: 'viv√≠a (imperfect)', example: 'Habitual in childhood = IMPERFECT' },
            { category: 'Past Tenses', word: 'El a√±o pasado ___ (viajar) a Jap√≥n.', pronunciation: 'specific time', answer: 'viaj√© (preterite)', example: 'Specific past time = PRETERITE' },
            { category: 'Past Tenses', word: '___ (estar) durmiendo cuando son√≥.', pronunciation: 'background action', answer: 'Estaba (imperfect)', example: 'Background/ongoing = IMPERFECT' },
            // More Idioms
            { category: 'Idioms', word: 'tirar la toalla', pronunciation: 'tee-RAHR lah toh-AH-yah', answer: 'to throw in the towel / give up', example: '"No voy a tirar la toalla."' },
            { category: 'Idioms', word: 'estar como pez en el agua', pronunciation: 'ehs-TAHR KOH-moh pehs...', answer: 'to be in one\'s element', example: '"Est√° como pez en el agua aqu√≠."' },
            { category: 'Idioms', word: 'no tener dos dedos de frente', pronunciation: 'noh teh-NEHR dohs DEH-dohs...', answer: 'to be stupid/clueless', example: 'Literally: not have two fingers of forehead' },
            { category: 'Idioms', word: 'ponerse las pilas', pronunciation: 'poh-NEHR-seh lahs PEE-lahs', answer: 'to get one\'s act together', example: '"Tienes que ponerte las pilas."' },
            { category: 'Idioms', word: 'dormir a pierna suelta', pronunciation: 'dohr-MEER ah pee-EHR-nah...', answer: 'to sleep like a log', example: '"Dorm√≠ a pierna suelta anoche."' },
            { category: 'Idioms', word: 'llover sobre mojado', pronunciation: 'yoh-VEHR SOH-breh moh-HAH-doh', answer: 'to add insult to injury', example: '"Y encima llueve sobre mojado."' },
            { category: 'Idioms', word: 'echar le√±a al fuego', pronunciation: 'eh-CHAHR LEH-nyah ahl FWEH-goh', answer: 'to add fuel to the fire', example: 'Don\'t make things worse!' },
            { category: 'Idioms', word: 'buscar tres pies al gato', pronunciation: 'boos-KAHR trehs pee-EHS...', answer: 'to overcomplicate things', example: '"No busques tres pies al gato."' },
            { category: 'Idioms', word: 'estar en el quinto pino', pronunciation: 'ehs-TAHR ehn ehl KEEN-toh PEE-noh', answer: 'to be very far away', example: '"Su casa est√° en el quinto pino."' },
            { category: 'Idioms', word: 'tener mala leche', pronunciation: 'teh-NEHR MAH-lah LEH-cheh', answer: 'to be bad-tempered', example: '"Hoy tiene muy mala leche."' },
            // More False Friends
            { category: 'False Friends', word: 'asistir', pronunciation: 'ah-sees-TEER', answer: 'to attend (NOT assist)', example: 'Use "ayudar" for assist' },
            { category: 'False Friends', word: 'introducir', pronunciation: 'een-troh-doo-SEER', answer: 'to insert (NOT introduce)', example: 'Use "presentar" to introduce people' },
            { category: 'False Friends', word: 'pretender', pronunciation: 'preh-tehn-DEHR', answer: 'to try/attempt (NOT pretend)', example: 'Use "fingir" for pretend' },
            { category: 'False Friends', word: 'recordar', pronunciation: 'reh-kohr-DAHR', answer: 'to remember (NOT record)', example: 'Use "grabar" for record' },
            { category: 'False Friends', word: 'ropa', pronunciation: 'ROH-pah', answer: 'clothes (NOT rope)', example: 'Rope = "cuerda"' },
            { category: 'False Friends', word: '√©xito', pronunciation: 'EHK-see-toh', answer: 'success (NOT exit)', example: 'Exit = "salida"' },
            { category: 'False Friends', word: 'librer√≠a', pronunciation: 'lee-breh-REE-ah', answer: 'bookstore (NOT library)', example: 'Library = "biblioteca"' },
            { category: 'False Friends', word: 'constipado', pronunciation: 'kohns-tee-PAH-doh', answer: 'having a cold (NOT constipated)', example: 'Constipated = "estre√±ido"' },
            // Slang/Casual (new category)
            { category: 'Vocabulary', word: 'guay (Spain)', pronunciation: 'gwai', answer: 'cool/great', example: '"¬°Qu√© guay!" = How cool!' },
            { category: 'Vocabulary', word: 'chido (Mexico)', pronunciation: 'CHEE-doh', answer: 'cool/awesome', example: '"Est√° muy chido."' },
            { category: 'Vocabulary', word: 'bac√°n (S. America)', pronunciation: 'bah-KAHN', answer: 'cool/great', example: '"Tu casa es bac√°n."' },
            { category: 'Vocabulary', word: 'mola (Spain)', pronunciation: 'MOH-lah', answer: 'it\'s cool', example: '"Eso mola mucho."' },
            { category: 'Vocabulary', word: 'flipar (Spain)', pronunciation: 'flee-PAHR', answer: 'to freak out/be amazed', example: '"Estoy flipando."' },
        ];

        let cards = [];
        let currentIndex = 0;
        let correctCount = 0;
        let reviewCount = 0;
        let startX = 0;
        let startY = 0;
        let currentX = 0;
        let isDragging = false;
        let currentCard = null;

        function shuffle(array) {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        function initSession() {
            cards = shuffle(cardData);
            currentIndex = 0;
            correctCount = 0;
            reviewCount = 0;
            renderCards();
            updateProgress();
        }

        function renderCards() {
            const stack = document.getElementById('cardStack');
            stack.innerHTML = '';

            // Render up to 3 cards
            for (let i = Math.min(currentIndex + 2, cards.length - 1); i >= currentIndex; i--) {
                const card = cards[i];
                const depth = i - currentIndex;

                const cardEl = document.createElement('div');
                cardEl.className = 'flashcard' + (depth === 1 ? ' behind' : '') + (depth === 2 ? ' far-behind' : '');
                cardEl.innerHTML = `
                    <div class="swipe-indicator left">Review</div>
                    <div class="swipe-indicator right">Got it!</div>
                    <div class="card-category">${card.category}</div>
                    <div class="card-word">${card.word}</div>
                    <div class="card-pronunciation">${card.pronunciation}</div>
                    <div class="card-divider"></div>
                    <div class="card-answer">${card.answer}</div>
                    <div class="card-example">${card.example}</div>
                    <div class="tap-hint">Tap to reveal</div>
                `;

                if (depth === 0) {
                    setupCardInteraction(cardEl);
                }

                stack.appendChild(cardEl);
            }
        }

        function setupCardInteraction(cardEl) {
            currentCard = cardEl;

            // Tap to reveal
            cardEl.addEventListener('click', (e) => {
                if (!isDragging) {
                    cardEl.classList.toggle('revealed');
                }
            });

            // Touch events
            cardEl.addEventListener('touchstart', handleTouchStart, { passive: true });
            cardEl.addEventListener('touchmove', handleTouchMove, { passive: false });
            cardEl.addEventListener('touchend', handleTouchEnd);

            // Mouse events
            cardEl.addEventListener('mousedown', handleMouseDown);
        }

        function handleTouchStart(e) {
            startX = e.touches[0].clientX;
            startY = e.touches[0].clientY;
            isDragging = false;
            currentCard.classList.add('grabbing');
        }

        function handleTouchMove(e) {
            if (!startX) return;

            currentX = e.touches[0].clientX - startX;
            const currentY = e.touches[0].clientY - startY;

            // If moving more horizontally than vertically, it's a swipe
            if (Math.abs(currentX) > Math.abs(currentY) && Math.abs(currentX) > 10) {
                isDragging = true;
                e.preventDefault();
                updateCardPosition(currentX);
            }
        }

        function handleTouchEnd() {
            currentCard.classList.remove('grabbing');
            if (isDragging) {
                handleSwipeEnd();
            }
            startX = 0;
            currentX = 0;
            isDragging = false;
        }

        function handleMouseDown(e) {
            startX = e.clientX;
            isDragging = false;
            currentCard.classList.add('grabbing');

            const handleMouseMove = (e) => {
                currentX = e.clientX - startX;
                if (Math.abs(currentX) > 5) {
                    isDragging = true;
                    updateCardPosition(currentX);
                }
            };

            const handleMouseUp = () => {
                currentCard.classList.remove('grabbing');
                if (isDragging) {
                    handleSwipeEnd();
                }
                startX = 0;
                currentX = 0;
                isDragging = false;
                document.removeEventListener('mousemove', handleMouseMove);
                document.removeEventListener('mouseup', handleMouseUp);
            };

            document.addEventListener('mousemove', handleMouseMove);
            document.addEventListener('mouseup', handleMouseUp);
        }

        function updateCardPosition(x) {
            const rotate = x * 0.1;
            currentCard.style.transform = `translateX(${x}px) rotate(${rotate}deg)`;

            currentCard.classList.remove('swiping-left', 'swiping-right');
            if (x < -50) {
                currentCard.classList.add('swiping-left');
            } else if (x > 50) {
                currentCard.classList.add('swiping-right');
            }
        }

        function handleSwipeEnd() {
            const threshold = 100;

            if (currentX > threshold) {
                swipeCard('right');
            } else if (currentX < -threshold) {
                swipeCard('left');
            } else {
                // Reset position
                currentCard.style.transform = '';
                currentCard.classList.remove('swiping-left', 'swiping-right');
            }
        }

        function swipeCard(direction) {
            const card = currentCard;
            const exitX = direction === 'right' ? window.innerWidth : -window.innerWidth;

            card.classList.add('exiting');
            card.style.transform = `translateX(${exitX}px) rotate(${direction === 'right' ? 30 : -30}deg)`;
            card.style.opacity = '0';

            if (direction === 'right') {
                correctCount++;
                markCardLearned(currentIndex);
            } else {
                reviewCount++;
                markCardForReview(currentIndex);
            }

            setTimeout(() => {
                currentIndex++;
                if (currentIndex >= cards.length) {
                    showStats();
                } else {
                    renderCards();
                    updateProgress();
                }
            }, 300);
        }

        function updateProgress() {
            const progress = ((currentIndex + 1) / cards.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('cardCount').textContent = `${currentIndex + 1}/${cards.length}`;
        }

        function markCardLearned(index) {
            const progress = JSON.parse(localStorage.getItem('yespanol_progress') || '{}');
            progress.wordsLearned = (progress.wordsLearned || 0) + 1;
            progress.totalCorrect = (progress.totalCorrect || 0) + 1;
            progress.totalAttempts = (progress.totalAttempts || 0) + 1;
            progress.accuracy = Math.round((progress.totalCorrect / progress.totalAttempts) * 100);
            localStorage.setItem('yespanol_progress', JSON.stringify(progress));
        }

        function markCardForReview(index) {
            const progress = JSON.parse(localStorage.getItem('yespanol_progress') || '{}');
            progress.totalAttempts = (progress.totalAttempts || 0) + 1;
            progress.accuracy = Math.round(((progress.totalCorrect || 0) / progress.totalAttempts) * 100);
            // Add to spaced repetition queue
            const reviewQueue = progress.reviewQueue || [];
            reviewQueue.push({ card: cards[index], nextReview: Date.now() + 60000 }); // Review in 1 min
            progress.reviewQueue = reviewQueue;
            localStorage.setItem('yespanol_progress', JSON.stringify(progress));
        }

        function showStats() {
            document.getElementById('statCorrect').textContent = correctCount;
            document.getElementById('statReview').textContent = reviewCount;
            document.getElementById('statsOverlay').classList.add('visible');
        }

        function restartSession() {
            document.getElementById('statsOverlay').classList.remove('visible');
            initSession();
        }

        // Button handlers
        document.getElementById('btnReveal').addEventListener('click', () => {
            if (currentCard) currentCard.classList.add('revealed');
        });

        document.getElementById('btnSkip').addEventListener('click', () => {
            if (currentCard) swipeCard('left');
        });

        document.getElementById('btnGotIt').addEventListener('click', () => {
            if (currentCard) swipeCard('right');
        });

        // Init
        initSession();
    </script>
</body>
</html>
